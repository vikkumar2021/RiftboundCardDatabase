generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Card {
  id                 String   @id @default(uuid())
  riotId             String   @unique // internal Riot ID
  publicCode         String   @unique // e.g. "OGN-056"
  name               String
  collectorNumber    String
  domain             String   // "Body", "Calm", "Chaos", "Colorless", "Fury", "Mind", "Order"
  type               String   // "Unit", "Spell", "Gear", "Legend", "Battlefield", "Rune"
  superTypes         Json     // string[] — e.g. ["Champion"]
  rarity             String   // "Common", "Uncommon", "Rare", "Epic", "Showcase"
  energy             String?  // mana cost
  might              String?  // attack
  power              String?  // health/defense
  tags               Json     // string[] — e.g. ["Mech", "Piltover"]
  rulesHtml          String?  @db.Text // ability text as HTML
  rulesText          String?  @db.Text // plain-text version for search
  artist             String?
  imageUrl           String   // full-res image from cmsassets.rgpub.io
  orientation        String   @default("portrait")
  setId              String
  lastUpdated        DateTime @default(now()) @updatedAt

  set Expansion @relation(fields: [setId], references: [id])

  @@index([domain])
  @@index([rarity])
  @@index([type])
  @@index([setId])
  @@index([name])
  @@index([publicCode])
  @@index([artist])
}

model Expansion {
  id    String @id // "OGN", "SFD", "OGS"
  name  String @unique

  cards Card[]
}

model PatchChange {
  id           String   @id @default(uuid())
  cardId       String
  fieldChanged String
  oldValue     String?  @db.Text
  newValue     String?  @db.Text
  changeDate   DateTime @default(now())

  @@index([cardId])
  @@index([changeDate])
}
